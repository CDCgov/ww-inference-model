% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/wwinference.R
\name{wwinference}
\alias{wwinference}
\title{Joint inference of count data (e.g. cases/admissions) and wastewater
data}
\usage{
wwinference(
  ww_data,
  count_data,
  model_spec = wwinference::get_model_spec(forecast_date = "2023-12-06"),
  mcmc_options = wwinference::get_mcmc_options(),
  compiled_model = wwinference::compile_model()
)
}
\arguments{
\item{ww_data}{A dataframe containing the pre-processed, site-level
wastewater concentration data for a model run. The dataframe must contain
the following columns: \code{date}, \code{site}, \code{lab}, \code{genome_copies_per_ml},
\code{lab_site_index}, \code{lod}, \code{below_lod}, \code{site_pop} \code{exclude}}

\item{count_data}{A dataframe containing the pre-procssed, "global" (e.g.
state) daily count data, pertaining to the number of events that are being
counted on that day, e.g. number of daily cases or daily hospital admissions.
Must contain the following columns: \code{date}, \code{count} , \code{total_pop}}

\item{model_spec}{The model specification parameters as defined using
\code{get_model_spec()}. The default here pertains to the \code{forecast_date} in the
example data provided by the package, but this should be specified by the
user based on the date they are producing a forecast}

\item{mcmc_options}{The MCMC parameters as defined using
\code{get_mcmc_options()}.}

\item{compiled_model}{The pre-compiled model as defined using
\code{compile_model()}}
}
\value{
A nested list of the following items, intended to allow the user to
quickly and easily plot results from their inference, while also being able
to have the full user functionality of running the model themselves in stan
by providing the raw model object and diagnostics. If the model runs, this
function will return:
\code{draws_df}: A tibble containing the full set of posterior draws of the
estimated, nowcasted, and forecasted: counts, site-level wastewater
concentrations, "global"(e.g. state) R(t) estimate, and the  "local" (site +
the one auxiliary subpopulation) R(t) estimates. In the instance where there
are observations, the data will be joined to each draw of the predicted
observation to facilitate plotting.
\code{raw_fit_obj}: The CmdStan object that is returned from the call to
\code{cmdstanr::sample()}. Can be used to access draws, summary, diagnostics, etc.
\code{date_time_spine}: Mapping from time in stan to dates
\code{lab_site_spine}: Mapping from lab_site_index in stan to lab and site
\code{subpop_spine}: Mapping from site index in stan to site

If the model fails to run, a list containing the follow will be returned:
\code{error}: the error message provided from stan, indicating why the model
failed to run. Note, the model might still run and produce draws even if it
has major model issues. We recommend the user always run the
\code{check_diagnostics()} function on the \code{diagnostic_summary} as part of any
pipeline to ensure model convergence.
}
\description{
Provides a user friendly interface around package functionality
to produce estimates, nowcasts, and forecasts pertaining to user-specified
delay distributions, set parameters, and priors that can be modified to handle
different types of "global" count data and "local" wastewater concentration
data using a Bayesian hierarchical framework applied to the two distinct
data sources. By default the model assumes a fixed generation interval and
delay from infection to the event that is counted. See the getting started
vignette for an example model specifications fitting COVID-19 hospital
admissions from a hypothetical state and wasteawter concentration data from
multiple sites within that state.
}
\examples{
\dontshow{if (interactive()) (if (getRversion() >= "3.4") withAutoprint else force)(\{ # examplesIf}
# provide all the code and commenting in the getting started vignette
\dontshow{\}) # examplesIf}
}
